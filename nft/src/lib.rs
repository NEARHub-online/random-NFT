use std::collections::HashMap;
use near_sdk::borsh::{self, BorshDeserialize, BorshSerialize};
use near_sdk::collections::{LazyOption, LookupMap, UnorderedMap, UnorderedSet};
use near_sdk::json_types::{Base64VecU8, U128};
use near_sdk::serde::{Deserialize, Serialize};
use near_sdk::serde_json::json;
use near_sdk::{
    env, near_bindgen, AccountId, Balance, CryptoHash, PanicOnDefault, Promise, PromiseOrValue, Gas, ext_contract
};

use crate::internal::*;
pub use crate::metadata::*;
pub use crate::mint::*;
pub use crate::nft_core::*;
pub use crate::approval::*;
pub use crate::royalty::*;
pub use crate::events::*;

mod internal;
mod approval; 
mod enumeration; 
mod metadata; 
mod mint; 
mod nft_core; 
mod royalty; 
mod events;

/// This spec can be treated like a version of the standard.
pub const NFT_METADATA_SPEC: &str = "1.0.0";
/// This is the name of the NFT standard we're using
pub const NFT_STANDARD_NAME: &str = "nep171";

const DATA_IMAGE_SVG_NEAR_ICON: &str = "data:image/png;base64,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";
const MAX_NFT_MINT: u16 = 1111;
const MAX_NFT_MINT_USERS: u16 = 1111;
const NFT_IMAGES: &str = "https://cloudflare-ipfs.com/ipfs/bafybeicvwxrcls3n3d2vdkefeqzb2hdegqocggvzj4jt5wzsj7mvhdfmce/";

const GAS_RESERVED_FOR_CURRENT_CALL: Gas = Gas(20_000_000_000_000);

#[near_bindgen]
#[derive(BorshDeserialize, BorshSerialize, PanicOnDefault)]
pub struct Contract {
    //contract owner
    pub owner_id: AccountId,

    //keeps track of all the token IDs for a given account
    pub tokens_per_owner: LookupMap<AccountId, UnorderedSet<TokenId>>,

    //keeps track of the token struct for a given token ID
    pub tokens_by_id: LookupMap<TokenId, Token>,

    //keeps track of the token metadata for a given token ID
    pub token_metadata_by_id: UnorderedMap<TokenId, TokenMetadata>,

    //keeps track of the metadata for the contract
    pub metadata: LazyOption<NFTContractMetadata>,
    pub token_minted: u16,
    pub token_minted_users: u16,
    pub perpetual_royalties: UnorderedMap<AccountId, u32>,
}

/// Helper structure for keys of the persistent collections.
#[derive(BorshSerialize)]
pub enum StorageKey {
    TokensPerOwner,
    TokenPerOwnerInner { account_id_hash: CryptoHash },
    TokensById,
    TokenMetadataById,
    NFTContractMetadata,
    TokensPerType,
    TokensPerTypeInner { token_type_hash: CryptoHash },
    TokenTypesLocked,
    Royalties,
}

#[near_bindgen]
impl Contract {
    /*
        initialization function (can only be called once).
        this initializes the contract with default metadata so the
        user doesn't have to manually type metadata.
    */
    #[init]
    pub fn new_default_meta(owner_id: AccountId) -> Self {
        assert!(
            env::is_valid_account_id(owner_id.as_bytes()),
            "The owner account ID is invalid"
        );
        //calls the other function "new: with some default metadata and the owner_id passed in 
        Self::new(
            owner_id,
            NFTContractMetadata {
                spec: "nft-1.0.0".to_string(),
                name: "GemZ: Masters of Infinity".to_string(),
                symbol: "GEMZ".to_string(),
                icon: Some(DATA_IMAGE_SVG_NEAR_ICON.to_string()),
                base_uri: None,
                reference: None,
                reference_hash: None,
            }
        )
    }

    /*
        initialization function (can only be called once).
        this initializes the contract with metadata that was passed in and
        the owner_id. 
    */
    #[init]
    pub fn new(owner_id: AccountId, metadata: NFTContractMetadata) -> Self {
        //create a variable of type Self with all the fields initialized. 
        Self {
            //Storage keys are simply the prefixes used for the collections. This helps avoid data collision
            tokens_per_owner: LookupMap::new(StorageKey::TokensPerOwner.try_to_vec().unwrap()),
            tokens_by_id: LookupMap::new(StorageKey::TokensById.try_to_vec().unwrap()),
            token_metadata_by_id: UnorderedMap::new(
                StorageKey::TokenMetadataById.try_to_vec().unwrap(),
            ),
            //set the owner_id field equal to the passed in owner_id. 
            owner_id,
            metadata: LazyOption::new(
                StorageKey::NFTContractMetadata.try_to_vec().unwrap(),
                Some(&metadata),
            ),
            token_minted: 0,
            token_minted_users: 0,
            perpetual_royalties: UnorderedMap::new(StorageKey::TokensById.try_to_vec().unwrap()),
        }
    }
}